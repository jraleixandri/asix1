<!DOCTYPE html>
<html lang="ES">
  <head>
    <meta charset="utf-8">
    <title>Dades Previsió Metereològica</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: darkblue; }
        .item { border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 5px; }
        h2 { margin: 0; color: darkred; }
        h3 { margin: 0; color: green; }
    </style>
  </head>
  <body>
    <h1>Dades Previsió Metereològica</h1>
    <div id="output">Carregant...</div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
          fetch("dadesobertes_pg.json")
            .then(response => response.json())
            .then(data => {
                const output = document.getElementById("output");
                output.innerHTML = renderObject(data);
            })
            .catch(error => {
                document.getElementById("output").innerHTML = "Error al carregar les dades.";
                console.error("Error carregant JSON:", error);
            });
      })
      function renderObject(obj) {
          let dia = 1;
          let html = "";
          for (let key in obj) {
              if (Array.isArray(obj[key])) {
                  obj[key].forEach(item => {
                      if (typeof item === "object") {
                          renderObject(item);
                      }
                  });
              } else if (typeof obj[key] === "object") {
                if (key === "variables") {
                  if (dia == 1){
                    html += `<div><h2><strong>Avui:</strong></h2>`;
                  }else if(dia == 2){
                    html += `<div><h2><strong>Demà:</strong></h2>`;
                  }else{
                    html += `<div><h2><strong>Passat:</strong></h2>`;
                  }
                  dia++;
                  renderObject(obj[key]);
                  html += "</div>";
                }
              } else {
                 if (key === "estatDelCel" || key === "precipitacions" || key === "visibilitat" || key === "temperatures" || key === "vent") {
                    html += `<div><strong>${key}:</strong> ${obj[key]}</div>`;
                 }
              }
          }
          return html;
      }        
/*                  
                  if (data.diapredit.versio.variables) {
                      const h2 = document.createElement("h2");
                      h2.textContent = JSON.stringify(data.diapredit.versio.variables, null, 2);
                      output.appendChild(h2);
                  } else {
                      output.textContent = "No s'ha trobat el camp 'variables'";
                  }
              })
              .catch(error => {
                  document.getElementById("output").textContent = "Error carregant les dades.";
                  console.error("Error carregant dades.json:", error);
              });
      });*/
      </script>
  </body>
</html>
